         +----------------+
         |                |
         |   STATE_INIT   |
         |                |
         +-------+--------+
                 |
                 v
         +-------+--------+
         |                |
         |  STATE_ALL_RED +<-------------------------+
         |                |                          |
         +-------+--------+                          |
                 |                                   |
    +------------+------------+                      |
    |                         |                      |
    v                         v                      |
+---+--------+       +--------+---+                  |
|                |   |                |              |
| STATE_NS_GREEN |   | STATE_EW_GREEN |              |
|                |   |                |              |
+-------+--------+   +--------+-------+              |
        |                     |                      |
        v                     v                      |
+-------+--------+   +--------+-------+              |
|                |   |                |              |
|STATE_NS_YELLOW |   |STATE_EW_YELLOW |              |
|                |   |                |              |
+-------+--------+   +--------+-------+              |
        |                     |                      |
        +----------+----------+                      |
                   |                                 |
                   v                                 |
         +-------+--------+                          |
         |                |                          |
         |  STATE_ALL_RED +--------------------------+
         |                |
         +-------+--------+
                 |
        +--------+--------+
        |                 |
        v                 v
+-------+--------+   +-------+--------+
|                |   |                |
|STATE_PED_CROSS |   | STATE_EMERGENCY |
|                |   |                |
+----------------+   +----------------+

Переходы по таймеру: сплошные линии
Переходы по событиям: пунктирные линии